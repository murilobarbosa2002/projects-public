(function(g){g.browser||(g.browser={},g.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),g.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),g.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),g.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()));var l={destroy:function(){g(this).unbind(".maskMoney");g.browser.msie&&(this.onpaste=null);return this},mask:function(){return this.trigger("mask")},init:function(c){c=
g.extend({symbol:"",symbolStay:!1,thousands:",",decimal:".",precision:2,defaultZero:!0,allowZero:!1,allowNegative:!1},c);return this.each(function(){function l(a){a=a||window.event;var d=a.which||a.charCode||a.keyCode;if(void 0==d)return!1;if(48>d||57<d){if(45==d)return k=!0,e.val(t(e)),!1;if(43==d)return k=!0,e.val(e.val().replace("-","")),!1;13==d||9==d?k&&(k=!1,g(this).change()):(!g.browser.mozilla||37!=d&&39!=d||0!=a.charCode)&&n(a);return!0}var b=e,f=b.val().length>=b.attr("maxlength")&&0<=b.attr("maxlength"),
c=p(b.get(0)),u=c.start,h=c.end;b=c.start!=c.end&&b.val().substring(u,h).match(/\d/)?!0:!1;if(!f||b)n(a),a=String.fromCharCode(d),d=e.get(0),b=p(d),f=b.start,b=b.end,d.value=d.value.substring(0,f)+a+d.value.substring(b,d.value.length),q(d,f+1),k=!0;return!1}function n(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function q(a,d){var b=e.val().length;e.val(r(a.value));var f=e.val().length;v(e,d-(b-f))}function r(a){a=a.replace(c.symbol,"");var d=a.length,b="",f="",e="";0!=d&&"-"==a.charAt(0)&&
(a=a.replace("-",""),c.allowNegative&&(e="-"));if(0==d&&!c.defaultZero)return f;for(var g=0;g<d&&("0"==a.charAt(g)||a.charAt(g)==c.decimal);g++);for(;g<d;g++)-1!="0123456789".indexOf(a.charAt(g))&&(b+=a.charAt(g));f=parseFloat(b);f=isNaN(f)?0:f/Math.pow(10,c.precision);f=f.toFixed(c.precision);g=0==c.precision?0:1;d=(f=f.split("."))[g].substr(0,c.precision);for(a=(f=f[0]).length;1<=(a-=3);)f=f.substr(0,a)+c.thousands+f.substr(a);return 0<c.precision?h(e+f+c.decimal+d+Array(c.precision+1-d.length).join(0)):
h(e+f)}function m(){return(0/Math.pow(10,c.precision)).toFixed(c.precision).replace(RegExp("\\.","g"),c.decimal)}function h(a){if(""!=c.symbol){var d="";0!=a.length&&"-"==a.charAt(0)&&(a=a.replace("-",""),d="-");a.substr(0,c.symbol.length)!=c.symbol&&(a=d+c.symbol+a)}return a}function t(a){a=a.val();return c.allowNegative?""!=a&&"-"==a.charAt(0)?a.replace("-",""):"-"+a:a}function v(a,d){g(a).each(function(a,f){if(f.setSelectionRange)f.focus(),f.setSelectionRange(d,d);else if(f.createTextRange){var b=
f.createTextRange();b.collapse(!0);b.moveEnd("character",d);b.moveStart("character",d);b.select()}});return this}function p(a){var d=0,b=0,f;if("number"==typeof a.selectionStart&&"number"==typeof a.selectionEnd)d=a.selectionStart,b=a.selectionEnd;else if((f=document.selection.createRange())&&f.parentElement()==a){var c=a.value.length;var e=a.value.replace(/\r\n/g,"\n");b=a.createTextRange();b.moveToBookmark(f.getBookmark());a=a.createTextRange();a.collapse(!1);-1<b.compareEndPoints("StartToEnd",a)?
d=b=c:(d=-b.moveStart("character",-c),d+=e.slice(0,d).split("\n").length-1,-1<b.compareEndPoints("EndToEnd",a)?b=c:(b=-b.moveEnd("character",-c),b+=e.slice(0,b).split("\n").length-1))}return{start:d,end:b}}var e=g(this),k=!1;e.unbind(".maskMoney");e.bind("keypress.maskMoney",l);e.bind("keydown.maskMoney",function(a){a=a||window.event;var d=a.which||a.charCode||a.keyCode;if(void 0==d)return!1;var b=e.get(0),c=p(b),h=c.start;c=c.end;return 8==d?(n(a),h==c?(b.value=b.value.substring(0,h-1)+b.value.substring(c,
b.value.length),--h):b.value=b.value.substring(0,h)+b.value.substring(c,b.value.length),q(b,h),k=!0,!1):9==d?(k&&(g(this).change(),k=!1),!0):46==d||63272==d?(n(a),b.value=b.selectionStart==b.selectionEnd?b.value.substring(0,h)+b.value.substring(c+1,b.value.length):b.value.substring(0,h)+b.value.substring(c,b.value.length),q(b,h),k=!0,!1):!0});e.bind("blur.maskMoney",function(a){g.browser.msie&&l(a);""==e.val()||e.val()==h(m())||e.val()==c.symbol?c.allowZero?c.symbolStay?e.val(h(m())):e.val(m()):e.val(""):
c.symbolStay?c.symbolStay&&e.val()==c.symbol&&e.val(h(m())):e.val(e.val().replace(c.symbol,""))});e.bind("focus.maskMoney",function(a){a=m();e.val()==a?e.val(""):""==e.val()&&c.defaultZero?e.val(h(a)):e.val(h(e.val()));this.createTextRange&&(a=this.createTextRange(),a.collapse(!1),a.select())});e.bind("mask.maskMoney",function(){var a=e.val();e.val(r(a))})})}};g.fn.maskMoney=function(c){if(l[c])return l[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)g.error("Method "+
c+" does not exist on jQuery.maskMoney");else return l.init.apply(this,arguments)}})(window.jQuery||window.Zepto);